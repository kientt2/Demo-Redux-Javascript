<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Redux Pure Javascript</title>
    <script src="js/jquery-3.6.0.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js" type="text/javascript"></script>
    <script src="js/redux.js" type="text/javascript"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

</head>
<body>
    <section>
        <h1>My hobbies list</h1>
        <h5>Add</h5>
        <form action="">
            <input id="formAdd" name="hobby" type="text">
        </form>
        <h5>List</h5>
        <ul id="hobbylist"></ul>
    </section>
</body>

<script>
    //REDUX
    //state
    let inititalState = JSON.parse(sessionStorage.getItem('hobby')) || ["Listen to music"]
    
    //reducer
    const hobbyReducer = function (state = inititalState, action) {
        switch (action.type) {
            case "ADD":
                state.push(action.payload);
                break;
            case "REMOVE":
                _.pull(state, action.payload);
                break;
            default:
                break;
        }
        sessionStorage.setItem('hobby', JSON.stringify(state))
        return [...state];  //must CLONE 
    }
    
    //store
    let store = Redux.createStore(hobbyReducer);
    store.subscribe(() => renderHobbies(store.getState()))

    
    //RENDER REDUX HOBBY LIST
    function renderHobbies(data) {
        let $html = data.map(el => `<li style="margin-bottom: 10px" data-remove="${el}">${el} <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeItem('${el}')">delete</button></li>`).join('')
        $("#hobbylist").html($html) 
        $("input").val("")  //reset.
    }
    
    function removeItem(hobby) {
        store.dispatch({
            type: "REMOVE",
            payload: hobby
        })
    }
    
    function addItem(hobby) {
        store.dispatch({
            type: "ADD",
            payload: hobby
        })
    }
    
    $("form").on("submit", function (e) {
        e.preventDefault();
        let hobby = $(this).serializeArray()[0].value;
        addItem(hobby)
    })
    
    $(document).ready(function () {
        renderHobbies(store.getState());
    })
    
</script>

<style>
    body {
        max-width: 400px;
        margin: auto;
    }
    li {
        margin-bottom: 10px;
    }
</style>
</html>